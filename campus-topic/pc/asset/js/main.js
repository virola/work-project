define(function(){function n(){$("a.add-redirect").each(function(n,t){var i=$(t).attr("href"),o=window.location.href;i+=(i.indexOf("?")>-1?"&":"?")+"redict_url="+encodeURIComponent(o),$(t).attr("href",i)}),$(".weixin").on("mouseover",function(){$(this).children("div").show()}).on("mouseout",function(){$(this).children("div").hide()})}function t(n){if(e)return alert("今天已投票，请明天再来！"),!1;var t=$(".group .btn").eq(n),i=$(".popup .btn").eq(n),o=t.children("em"),r=parseInt(o.text(),10)+1;t.add(i).find("em").text(r),e=1}function i(){$(".group .btn").on("click",function(){var n=$(this),i=$(".group .btn").index(n);return t(i),!1}),$(".popup .btn").on("click",function(){var n=$(this),i=$(".popup .btn").index(n);return t(i),!1}),$(".photo").on("click",function(){var n=$(this),t=$(".photo").index(n);return o(t),!1}),$(".mask").on("click",function(){$(this).hide(),$(".popup").hide()}),$(".popup-close").on("click",function(){return $(this).closest(".popup").hide(),$(".mask").hide(),!1})}function o(n){var t=$(".popup-"+n);if(t.size()>0){t.show();var i=($(window).width()-t.width())/2,o=Math.max($(window).scrollTop()+100,550);t.css({left:i+"px",top:o+"px"})}$(".mask").show().height($(document.documentElement).height())}var e,r={};return r.init=function(){n(),i()},r});