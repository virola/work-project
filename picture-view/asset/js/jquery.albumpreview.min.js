/**
 * pic
 * @version 2014-11-28 11:3:39
 */
!function(e,i,a){i.fn.albumpreview=function(e){e=i.extend({},i.fn.albumpreview.defaults,e);var n=e.path+"/loading.gif",o=e.path+"/zoomin.cur",s=e.path+"/zoomout.cur";o="url('"+o+"'), pointer",s="url('"+s+"'), pointer";var d=['<div class="ui-preview-toolbar" style="display:none">','<span class="ui-preview-buttons" style="display:none">','<a href="#" data-go="hide" class="ui-preview-hide"><span></span>',e.hide,"</a>",'<a href="#" data-go="left" class="ui-preview-left"><span></span>',e.left,"</a>",'<a href="#" data-go="right" class="ui-preview-right"><span></span>',e.right,"</a>",e.source?'<a href="#" data-go="source" class="ui-preview-source"><span></span>':"",e.source,"</a>","</span>",'<span class="ui-preview-loading">','<img data-live="stop" src="',n,'" style="',"display:inline-block;*zoom:1;*display:inline;vertical-align:middle;",'width:16px;height:16px;"'," />","</span>","</div>",'<div class="ui-preview-box" style="display:none"></div>'].join(""),l=['<div class="ui-preview-photo">','<div class="ui-preview-photo-wrap">','<img data-name="thumb" data-go="hide" data-live="stop" src="',n,'">',"</div>",'<a class="ui-preview-photo-prev" href="#" data-go="prev"></a>','<a class="ui-preview-photo-next" href="#" data-go="next"></a>',"</div>"].join("");return i(this).each(function(){function n(e){if(!(e==v||0>e||e>w-1)){s();var i=u.find(".ui-preview-box").show(),a=i.find(".ui-preview-photo").addClass("ui-preview-hidden");a.eq(e).removeClass("ui-preview-hidden"),c=a.eq(e),v=e}}function s(){f||(u.show().find(".ui-preview-toolbar").slideDown(150,function(){u.get(0).scrollIntoView()}),h.hide(),f=1)}var u,h=i(this),p=e.imgClass?"."+e.imgClass:"img";h.bind("click",p,function(e){u=h.data("albumpreview"),u||b();var i=e.target;if("IMG"!==i.nodeName||"stop"===i.getAttribute("data-live"))return!1;var a=h.find(p).index(i);return n(a),!1});var c,v,f,w=h.find(p).length,g=e.maxWidth||"auto",m=e.maxHeight||99999;g-=2*e.borderWidth;var b=function(){u=i("<div>").addClass("ui-preview ui-preview-noLoad").append(d).hide(),e.appendTo?h.closest(e.appendTo).append(u):h.after(u);var a=function(e){var i=e.target,a=i.getAttribute("data-go"),r=i.getAttribute("data-live"),o=c.data("preview-degree")||0,s=c.find(".ui-preview-show")[0];if("stop"===r)return!1;switch(/img|canvas$/i.test(i.nodeName)&&(a="hide"),a){case"left":o-=90,o=-90===o?270:o;break;case"right":o+=90,o=360===o?0:o;break;case"source":window.open(source||show||src);break;case"hide":x();break;case"prev":n(v-1);break;case"next":n(v+1)}return"left"!==a&&"right"!==a||!c.data("preview-photo-load")||(t(s,o,g,m),c.data("preview-degree",o)),!1};M(),u.bind("click","[data-go]",a),h.data("albumpreview",u)},x=function(){h.show(),u.hide(),u.remove(),v=-1,c=null,h.data("albumpreview",null),h.get(0).scrollIntoView(),f=0},M=function(){var t=u.find(".ui-preview-box");h.find(p).each(function(){var n=this;if("IMG"!==n.nodeName)return!1;var o=i(n),s=i(l).addClass("ui-preview-hidden").appendTo(t),d=s.find("[data-name=thumb]"),h=o.attr(e.showAttr);e.showAttr&&h||(h=n.src),r(h,function(){var i=this.width,a=this.height,t=Math.min(g,i);a=t/i*a,i=t,d.attr("src",n.src).css(e.blur?{width:i+"px",height:a+"px"}:{display:"none"}),d.after(['<img class="ui-preview-show" data-go="hide" title="',n.title,'" alt="',n.alt,'" src="',h,'" style="width:',i,"px;height:",a,'px;position:absolute;left:0;top:0;background:transparent"'," />"].join("")),d.attr("class","ui-preview-show"),u.addClass("ui-preview-ready"),u.find(".ui-preview-buttons").show(),s.data("albumpreview-ready",!0)},function(){var e=u.find(".ui-preview-show");d.removeAttr("class").removeAttr("data-live").hide(),e.css({position:"static",left:"auto",top:"auto"}),u.removeClass("ui-preview-noLoad"),u.find(".ui-preview-loading").hide(),s.data("preview-photo-load",!0)},function(){u.addClass("ui-preview-error"),a('jQuery.fn.albumpreview: Load "'+h+'" Error!')})}),t.find(".ui-preview-photo-prev:first").hide(),t.find(".ui-preview-photo-next:last").hide()};h.find(p).css({cursor:o})}),this},i.fn.albumpreview.defaults={imgClass:"",showAttr:"",path:"./images",left:"左旋转",right:"右旋转",source:"看原图",hide:"×",blur:!0,preload:!0,maxWidth:null,maxHeight:null,borderWidth:18,appendTo:""};var t=i.imgRotate=function(){var a=/msie (\d+\.\d+)/i.test(navigator.userAgent)?e.documentMode||+RegExp.$1:void 0;return function(e,t,r,n){var o=e.naturalWidth,s=e.naturalHeight;if(!("naturalWidth"in e)){var d=e.runtimeStyle,l=d.width,u=d.height;d.width=d.height="auto",e.naturalWidth=o=e.width,e.naturalHeight=s=e.height,d.width=l,d.height=u}var h,p=1,c=0,v=function(e){e?(o=[s,s=o][0],o>n&&(p=n/o,s=p*s,o=n),s>r&&(p=p*r/s,o=r/s*o,s=r),c=-(o-s)/2):(o>r&&(p=r/o,s=p*s,o=r),s>n&&(p=p*n/s,o=n/s*o,s=n))};switch(t){case 0:case 180:v();break;case 90:case 270:v(!0),h=1}if(a&&9>a){var f=t>180?t-360:-180>t?360+t:t,w=f*(2*Math.PI/360);console.log(f),console.log(w);var g=["progid:DXImagetransform.Microsoft.Matrix(","M11="+Math.cos(w)+",M12=-"+Math.sin(w)+",","M21="+Math.sin(w)+",M22="+Math.cos(w)+",","SizingMethod='auto expand'",")"].join("");g="progid:DXImageTransform.Microsoft.BasicImage(rotation="+t/90+")",0==w&&(g=""),i(e).css("filter",g)}else{var m="translate(0, "+c+"px) rotate("+t+"deg) scale(1,1)";i(e).css({transform:m})}i(e).parent().height(h?s:"auto")}}(),r=function(){var e=[],i=null,a=function(){for(var i=0;i<e.length;i++)e[i].end?e.splice(i--,1):e[i]();!e.length&&t()},t=function(){clearInterval(i),i=null};return function(t,r,n,o){var s,d,l,u,h,p=new Image;return p.src=t,p.complete?(r.call(p),void(n&&n.call(p))):(d=p.width,l=p.height,p.onerror=function(){o&&o.call(p),s.end=!0,p=p.onload=p.onerror=null},s=function(){u=p.width,h=p.height,(u!==d||h!==l||u*h>1024)&&(r.call(p),s.end=!0)},s(),p.onload=function(){!s.end&&s(),n&&n.call(p),p=p.onload=p.onerror=null},void(s.end||(e.push(s),null===i&&(i=setInterval(a,40)))))}}()}(document,jQuery,function(e){window.console&&console.log(e)});