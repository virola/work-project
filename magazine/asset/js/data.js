define(["jquery","util"],function(t,n){function e(n){var e=[];return t.each(n,function(t,n){e[t]=o(n)}),e.join("")}function r(){var t=Math.ceil(10*Math.random());return l[t]?r():(l[t]=1,c+t+".jpg")}function o(t){return t.bgurl=r(),u||(u=t.bgurl),n.format(d,t)}var i={},c="mock/bg/",a={};i.render=function(n,r){var o=n.url;t.getJSON(o).done(function(n){t("#content").html(e(n.pages)),document.title=a.title=n.name;var o=document.querySelector('head>meta[name="description"]'),i=document.querySelector('head>meta[name="keywords"]');i&&(i.content=n.keywords),o&&(o.content=a.content=n.description),r&&r()})};var u,d='<section style="background-image: url(#{bgurl})"><div class="page"><h2>#{title}</h2><p>#{content}</p></div></section>',l={};return i.getShareData=function(){return a.icon=getFirstImg(),a.link=window.location.href,a},i.getFirstImg=function(){var t=window.location.href,n=t.lastIndexOf("/");return t.substr(0,n)+"/"+u},i});